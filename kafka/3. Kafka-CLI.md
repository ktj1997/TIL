# 3. Kafka-CLI
- Kafka를 운영할 때 제일 많이 사용하는 툴이다.
- 실제 Kafka Broker가 설치된 서버에서도 가능하고, 접근이 열려있다면 원격에서도 가능하다.
- topic 관련 설정에는 필수옵션과 선택옵션이 있다. (선택 옵션 일시에는 default가 정해진다.)

## kafka-topics.sh
- topic 관련된 명령을 실행 할 수 있다.
- topic 생성이 가능하다.

### topic이 생성되는 경우
1. KafkaBroker에 존재하지 않는 Topic을 Producer가 Produce하거나 Consumer가 Consume하는 경우
2. **CLI로 명시적으로 Topic을 생성하는 경우**

### Topic 생성하기
```shell
$ bin/kafka-toipics.shj \
--create \
--bootstrap-server [KafkaBroker 설치 IP:PORT] \
--topic [토픽 이름] 
```

#### 필수옵션
- --create: 토픽 생성 명령어
- --bootstrap-server: Kafka Broker 위치
  - 이전에는 ZooKeeper에 요청을 보냈지만, 2.2버전 이후로는 Kafka와 직접 통신한다.
- --topic: 토픽 이름
  - topic 생성시 유효한 문자는 (영어,숫자,'.',',','-','_')가 있다.
  - '.'와'_'는 충돌 할 수 있기 때문에 하나만 사용해야 한다.

#### 선택옵션
- --partitions: 파티션의 개수
- --replication-factor: 파티션을 복제할 복제 개수 (default:1 --> 사용하지 않겠다.)
  - 실무에서는 2개 혹은 3개의 KafkaBroker를 사용하기 때문에 2혹은 3이 적당하다.
- --config: 추가적인 명령 실행
  - retention.ms: 토픽의 데이터를 유지하는 기간 (default: 1일)

### Topic 조회하기

#### Topic 리스트 조회하기
```shell
$ bin/kafka-topics.sh \
--bootstrap-server [KafkaBroker 설치 IP:PORT] \
--list
```

#### Topic 상세정보 조회하기
```shell
$ bin/kafka-topics.sh \
--bootstrap-server [KafkaBroker 설치 IP:PORT] \
--describe --topic [Topic 이름]
```
```text
Topic: hello.kafka      TopicId: XncBEseKQ_OJrP3UMxwQkQ PartitionCount: 1       ReplicationFactor: 1    Configs: segment.bytes=1073741824
        Topic: hello.kafka      Partition: 0    Leader: 0       Replicas: 0     Isr: 0
```