# 검색 엔진

**비정형 데이터(자연어) 를 검색 하는 기술**

## 데이터 형태

- 정형 데이터
    - 스키마에 따른 데이터 저장
    - RDBMS, XML의 형태
    
- 반정형 데이터
    - 명확한 스키마 존재(X)
    - 주로 JSON 형태를 의미
    
- 비정형 데이터
    - 스키마(X)
    - 비디오, 오디오 등의 멀티미디어, 텍스트, 웹자료 등을 의미


## 엘라스틱 서치
- Apache Lucene (오픈소스 인덱싱 엔진) 기반
- Java 기반 
- 플랫폼을 가리지 않음
- 실시간 분석 (index 작업이 끝나면 바로 검색 가능)
- 분산 시스템 (Scale Out 을 통한 확장 가능)
- HA (고가용성) 
- JSON 문서 기반 (Schema Free)
  - key : value 구조
  - Array와 Object로 이루어져있고 Nesting이 가능하다.
  
- REST 기반  
- 전문 검색 (FullTextSearch)
  - 시스템에 부하를 주지 않는 LIKE 쿼리
  - DBMS 파일/스키마의 구조 무시 
  - 전체내용을 큰 하나의 텍스트 파일로 보고 문자열 검색
  - StopWord
    - 구분자(공백, 구두점 등)  를 기준으로 분할 하는 방식
    - 전처리 부분만 다르고, B+트리 인덱스 방식을 사용
    - 한글의 경우 조사 처리문제 떄문에 잘 동작하지 않음
  
  - N-Gram
    - 기계적으로 N글자로 쪼개서 검색
    - 보통 N을 2~5로 설정
  - Inverted Index (역 인덱스)
    - snow : doc1,doc2,doc3
    - 단어가 포함된 문서들의 리스트 (인덱스가 역으로)
  
- Multi-Tenancy (하나의 서버에 여러 Index 저장, 여러 Index를 하나의 쿼리로 검색)
    - 범위를 지정하지 않고 모든 곳에대한 검색
- 분산 저장소
    - key 에 따라 여러개의 샤드로 분할 저장
    - 클러스터링 지원
    - 노드 추가/삭제 기능
    
## RDB에서 인덱스란? 
**기본적으로는 B+트리 인덱스**

### B+트리
- 바이너리 서치의 변형
- 인덱스와 파일을 구분
- 주로 문자열 검색에 사용 
- CUD에 따라 인덱스가 재배치되므로, CUD에는 불리
- 연속적인 검색에 취약(range)

### 해시
- 충돌이 발생하는 경우는 안됨
- 데이터가 많을 경우 충돌하는 빈도 수가 많아짐