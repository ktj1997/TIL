# 스크립트
- ${GRINDER_HOME}/script/admin에 위치한다.
- WebUI를 통해서 업로드 하는 것이 좋다.
  - Script파일도 외부에서 작성하고 올리는 것이 좋다.
  - 추가적으로 사용할 CSV파일 류도 마찬가지다.
- https://github.com/naver/ngrinder/wiki/How-to-use-resources
## 형식
```groovy
import static net.grinder.script.Grinder.grinder
import static org.junit.Assert.*
import static org.hamcrest.Matchers.*
import net.grinder.script.GTest
import net.grinder.script.Grinder
import net.grinder.scriptengine.groovy.junit.GrinderRunner
import net.grinder.scriptengine.groovy.junit.annotation.BeforeProcess
import net.grinder.scriptengine.groovy.junit.annotation.BeforeThread
// import static net.grinder.util.GrinderUtils.* // You can use this if you're using nGrinder after 3.2.3
import org.junit.Before
import org.junit.BeforeClass
import org.junit.Test
import org.junit.runner.RunWith

import org.ngrinder.http.HTTPRequest
import org.ngrinder.http.HTTPRequestControl
import org.ngrinder.http.HTTPResponse
import org.ngrinder.http.cookie.Cookie
import org.ngrinder.http.cookie.CookieManager

/**
* A simple example using the HTTP plugin that shows the retrieval of a single page via HTTP.
*
* This script is automatically generated by ngrinder.
*
* @author admin
*/
@RunWith(GrinderRunner)
class TestRunner {

	public static GTest test
	public static HTTPRequest request
	public static Map<String, String> headers = [:]
	public static Map<String, Object> params = [:]
	public static List<Cookie> cookies = []

	@BeforeProcess
	public static void beforeProcess() {
		HTTPRequestControl.setConnectionTimeout(300000)
		test = new GTest(1, "www.google.com")
		request = new HTTPRequest()
		grinder.logger.info("before process.")
	}

	@BeforeThread
	public void beforeThread() {
		test.record(this, "test")
		grinder.statistics.delayReports = true
		grinder.logger.info("before thread.")
	}

	@Before
	public void before() {
		request.setHeaders(headers)
		CookieManager.addCookies(cookies)
		grinder.logger.info("before. init headers and cookies")
	}

	@Test
	public void test() {
		HTTPResponse response = request.GET("https://www.google.com", params)

		if (response.statusCode == 301 || response.statusCode == 302) {
			grinder.logger.warn("Warning. The response may not be correct. The response code was {}.", response.statusCode)
		} else {
			assertThat(response.statusCode, is(200))
		}
	}
}
```
- @RunWith(GrinderRunner)를 통해서 nGrinder가 Junit의 행동을 제어 할 수 있게 된다.


## 에노테이션
| Annotation      | Description     | Applied To | Usage |
| ----------- | ----------- | ----------- | ----------- |
| `@BeforeProcess` | Define behaviors which should be executed before the process is invoked | Static method | Load resource files which are shared by threads. Define GTest and instrument the test target using record method |
| `@AfterProcess`  | Define behaviors which should be executed after the process is terminated | Static method | Close resource files |
| `@BeforeThread`  | Define behaviors which should be executed before each thread is executed | Member method | Login the target system. Set up the thread bounded values (For example, Cookie Handler) |
| `@AfterThread`   | Define behaviors which should be executed after each thread is executed | Member method | Logout the target system |
| `@Before`        | Define behaviors which should be executed before every `@Test` annotated method are executed | Member method | Common logic which is shared by the multiple `@Test` annotated methods. Variable set up |
| `@After`         | Define behaviors which should be executed after every `@Test` annotated methods are executed | Member method | Not used much |
| `@Test`          | Define the test behavior. Executed multiple times | Member method | Test body |